2024-12-07 15:37:17,433 - __main__ - INFO - Loading configuration...
2024-12-07 15:37:17,434 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:41:33,319 - __main__ - INFO - Loading configuration...
2024-12-07 15:41:33,320 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:42:12,247 - __main__ - INFO - Loading configuration...
2024-12-07 15:42:12,248 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:45:02,821 - __main__ - INFO - Loading configuration...
2024-12-07 15:45:02,822 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:47:20,172 - __main__ - INFO - Loading configuration...
2024-12-07 15:47:20,173 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:49:21,445 - __main__ - INFO - Loading configuration...
2024-12-07 15:49:21,446 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 63, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 65, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:50:58,480 - __main__ - INFO - Loading configuration...
2024-12-07 15:50:58,481 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 68, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 71, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:52:01,219 - __main__ - INFO - Loading configuration...
2024-12-07 15:52:01,220 - __main__ - ERROR - Error in main function: ADMIN_USER_ID must be a valid integer
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 68, in load_config
    admin_user_id = int(os.getenv('ADMIN_USER_ID'))
ValueError: invalid literal for int() with base 10: 'your_admin_telegram_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 34, in main
    config = load_config()
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/config.py", line 71, in load_config
    raise ValueError("ADMIN_USER_ID must be a valid integer")
ValueError: ADMIN_USER_ID must be a valid integer
2024-12-07 15:53:14,022 - __main__ - INFO - Loading configuration...
2024-12-07 15:53:14,023 - __main__ - INFO - Initializing bot...
2024-12-07 15:53:14,043 - __main__ - ERROR - Error in main function: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode='HTML')` argument instead.
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 38, in main
    bot = Bot(token=config.telegram.token, parse_mode="HTML")
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/client/bot.py", line 310, in __init__
    raise TypeError(
    ...<3 lines>...
    )
TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode='HTML')` argument instead.
2024-12-07 16:08:44,192 - __main__ - INFO - Loading configuration...
2024-12-07 16:08:44,194 - __main__ - INFO - Initializing bot...
2024-12-07 16:08:44,211 - __main__ - INFO - Initializing database...
2024-12-07 16:08:44,211 - __main__ - ERROR - Error in main function: object Database can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 43, in main
    db = await Database(config.database.path)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object Database can't be used in 'await' expression
2024-12-07 16:09:47,953 - __main__ - INFO - Loading configuration...
2024-12-07 16:09:47,954 - __main__ - INFO - Initializing bot...
2024-12-07 16:09:47,971 - __main__ - INFO - Initializing database...
2024-12-07 16:09:47,971 - __main__ - ERROR - Error in main function: 'Config' object has no attribute 'encryption'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 46, in main
    marketplace_factory = MarketplaceFactory(encryption_key=config.encryption.key)
                                                            ^^^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'encryption'. Did you mean: 'encryption_key'?
2024-12-07 16:10:35,017 - __main__ - INFO - Loading configuration...
2024-12-07 16:10:35,018 - __main__ - INFO - Initializing bot...
2024-12-07 16:10:35,036 - __main__ - INFO - Initializing database...
2024-12-07 16:10:35,036 - __main__ - ERROR - Error in main function: Fernet key must be 32 url-safe base64-encoded bytes.
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/cryptography/fernet.py", line 34, in __init__
    key = base64.urlsafe_b64decode(key)
  File "/usr/local/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/base64.py", line 134, in urlsafe_b64decode
    return b64decode(s)
  File "/usr/local/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/base64.py", line 88, in b64decode
    return binascii.a2b_base64(s, strict_mode=validate)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
binascii.Error: Incorrect padding

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 46, in main
    marketplace_factory = MarketplaceFactory(encryption_key=config.encryption_key)
  File "/Users/kagitin/CascadeProjects/priceguard/src/services/marketplaces/factory.py", line 22, in __init__
    self.fernet = Fernet(encryption_key.encode())
                  ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/cryptography/fernet.py", line 36, in __init__
    raise ValueError(
        "Fernet key must be 32 url-safe base64-encoded bytes."
    ) from exc
ValueError: Fernet key must be 32 url-safe base64-encoded bytes.
2024-12-07 16:11:49,069 - __main__ - INFO - Loading configuration...
2024-12-07 16:11:49,070 - __main__ - INFO - Initializing bot...
2024-12-07 16:11:49,087 - __main__ - INFO - Initializing database...
2024-12-07 16:11:49,088 - __main__ - ERROR - Error in main function: NotificationService.__init__() got an unexpected keyword argument 'database'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 49, in main
    notification_service = NotificationService(bot=bot, database=db)
TypeError: NotificationService.__init__() got an unexpected keyword argument 'database'
2024-12-07 16:12:53,171 - __main__ - INFO - Loading configuration...
2024-12-07 16:12:53,172 - __main__ - INFO - Initializing bot...
2024-12-07 16:12:53,190 - __main__ - INFO - Initializing database...
2024-12-07 16:12:53,190 - __main__ - ERROR - Error in main function: PromotionMonitor.__init__() got an unexpected keyword argument 'database'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 52, in main
    monitor = PromotionMonitor(
        database=db,
        notification_service=notification_service,
        client_factory=marketplace_factory
    )
TypeError: PromotionMonitor.__init__() got an unexpected keyword argument 'database'
2024-12-07 16:13:45,147 - __main__ - INFO - Loading configuration...
2024-12-07 16:13:45,148 - __main__ - INFO - Initializing bot...
2024-12-07 16:13:45,165 - __main__ - INFO - Initializing database...
2024-12-07 16:13:45,166 - __main__ - ERROR - Error in main function: 'Database' object has no attribute 'telegram'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 58, in main
    setup_middlewares(dp, db)
    ~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/__init__.py", line 20, in setup_middlewares
    dp.message.middleware(AuthMiddleware(config.telegram.admin_user_id))
                                         ^^^^^^^^^^^^^^^
AttributeError: 'Database' object has no attribute 'telegram'
2024-12-07 16:14:34,897 - __main__ - INFO - Loading configuration...
2024-12-07 16:14:34,898 - __main__ - INFO - Initializing bot...
2024-12-07 16:14:34,918 - __main__ - INFO - Initializing database...
2024-12-07 16:14:34,918 - __main__ - ERROR - Error in main function: register_all_handlers() missing 2 required positional arguments: 'config' and 'db'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 66, in main
    register_all_handlers(dp)
    ~~~~~~~~~~~~~~~~~~~~~^^^^
TypeError: register_all_handlers() missing 2 required positional arguments: 'config' and 'db'
2024-12-07 16:15:22,679 - __main__ - INFO - Loading configuration...
2024-12-07 16:15:22,680 - __main__ - INFO - Initializing bot...
2024-12-07 16:15:22,697 - __main__ - INFO - Initializing database...
2024-12-07 16:15:22,697 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:15:22,697 - __main__ - INFO - Starting bot...
2024-12-07 16:15:22,697 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:15:22,698 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:15:23,316 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:16:35,310 - aiogram.event - INFO - Update id=20180897 is not handled. Duration 0 ms by bot id=7683347152
2024-12-07 16:16:35,311 - aiogram.event - ERROR - Cause exception while process update id=20180897 by bot id=7683347152
RuntimeError: Database not initialized
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/auth.py", line 38, in __call__
    user_data = await db.get_user(user.id)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/core/database.py", line 149, in get_user
    raise RuntimeError("Database not initialized")
RuntimeError: Database not initialized
2024-12-07 16:16:49,574 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:16:49,575 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:16:49,575 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 16:17:35,338 - __main__ - INFO - Loading configuration...
2024-12-07 16:17:35,339 - __main__ - INFO - Initializing bot...
2024-12-07 16:17:35,356 - __main__ - INFO - Initializing database...
2024-12-07 16:17:35,370 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:17:35,370 - __main__ - INFO - Starting bot...
2024-12-07 16:17:35,370 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:17:35,370 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:17:35,697 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:17:45,462 - bot.middlewares.auth - INFO - New user registered: 743731
2024-12-07 16:17:46,034 - aiogram.event - INFO - Update id=20180898 is handled. Duration 575 ms by bot id=7683347152
2024-12-07 16:17:49,811 - aiogram.event - INFO - Update id=20180899 is handled. Duration 130 ms by bot id=7683347152
2024-12-07 16:18:10,441 - bot.middlewares.error - ERROR - Error processing event from user 743731: cmd_admin() missing 1 required positional argument: 'settings'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ~~~~~~~^^
TypeError: cmd_admin() missing 1 required positional argument: 'settings'
2024-12-07 16:18:10,933 - aiogram.event - INFO - Update id=20180900 is handled. Duration 492 ms by bot id=7683347152
2024-12-07 16:19:00,358 - aiogram.event - INFO - Update id=20180901 is handled. Duration 389 ms by bot id=7683347152
2024-12-07 16:19:03,541 - aiogram.event - INFO - Update id=20180902 is handled. Duration 402 ms by bot id=7683347152
2024-12-07 16:19:09,615 - aiogram.event - INFO - Update id=20180903 is not handled. Duration 1 ms by bot id=7683347152
2024-12-07 16:19:14,137 - aiogram.event - INFO - Update id=20180904 is not handled. Duration 1 ms by bot id=7683347152
2024-12-07 16:19:17,380 - aiogram.event - INFO - Update id=20180905 is handled. Duration 275 ms by bot id=7683347152
2024-12-07 16:19:23,036 - aiogram.event - INFO - Update id=20180906 is handled. Duration 111 ms by bot id=7683347152
2024-12-07 16:19:25,195 - aiogram.event - INFO - Update id=20180907 is not handled. Duration 1 ms by bot id=7683347152
2024-12-07 16:20:02,146 - aiogram.event - INFO - Update id=20180908 is handled. Duration 395 ms by bot id=7683347152
2024-12-07 16:20:25,531 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:20:25,531 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:20:25,532 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 16:21:21,233 - __main__ - INFO - Loading configuration...
2024-12-07 16:21:21,234 - __main__ - INFO - Initializing bot...
2024-12-07 16:21:21,250 - __main__ - INFO - Initializing database...
2024-12-07 16:21:21,252 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:21:21,252 - __main__ - INFO - Starting bot...
2024-12-07 16:21:21,252 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:21:21,252 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:21:21,976 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:21:31,351 - aiogram.event - INFO - Update id=20180909 is handled. Duration 389 ms by bot id=7683347152
2024-12-07 16:21:35,583 - bot.middlewares.error - ERROR - Error processing event from user 743731: cmd_admin() missing 1 required positional argument: 'settings'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ~~~~~~~^^
TypeError: cmd_admin() missing 1 required positional argument: 'settings'
2024-12-07 16:21:35,903 - aiogram.event - INFO - Update id=20180910 is handled. Duration 320 ms by bot id=7683347152
2024-12-07 16:22:19,866 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:22:19,867 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:22:19,867 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 16:22:41,629 - __main__ - INFO - Loading configuration...
2024-12-07 16:22:41,630 - __main__ - INFO - Initializing bot...
2024-12-07 16:22:41,649 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:22:41,650 - __main__ - INFO - Starting bot...
2024-12-07 16:22:41,650 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:22:41,650 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:22:42,286 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:22:50,752 - aiogram.event - INFO - Update id=20180911 is handled. Duration 398 ms by bot id=7683347152
2024-12-07 16:22:54,829 - bot.middlewares.error - ERROR - Error processing event from user 743731: 'Config' object has no attribute 'admin_user_id'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/admin.py", line 37, in cmd_admin
    if not await is_admin(message.from_user.id, settings):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/admin.py", line 32, in is_admin
    return str(user_id) == settings.admin_user_id
                           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'admin_user_id'
2024-12-07 16:22:55,093 - aiogram.event - INFO - Update id=20180912 is handled. Duration 265 ms by bot id=7683347152
2024-12-07 16:23:11,888 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:23:11,888 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:23:11,889 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 16:23:44,618 - __main__ - INFO - Loading configuration...
2024-12-07 16:23:44,619 - __main__ - INFO - Initializing bot...
2024-12-07 16:23:44,638 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:23:44,638 - __main__ - INFO - Starting bot...
2024-12-07 16:23:44,638 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:23:44,639 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:23:44,977 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:23:53,883 - aiogram.event - INFO - Update id=20180913 is handled. Duration 376 ms by bot id=7683347152
2024-12-07 16:23:57,845 - aiogram.event - INFO - Update id=20180914 is handled. Duration 141 ms by bot id=7683347152
2024-12-07 16:24:04,456 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:24:04,457 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:24:04,457 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 16:24:04,647 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:25:25,148 - __main__ - INFO - Loading configuration...
2024-12-07 16:25:25,149 - __main__ - INFO - Initializing bot...
2024-12-07 16:25:25,168 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 16:25:25,168 - __main__ - INFO - Starting bot...
2024-12-07 16:25:25,168 - aiogram.dispatcher - INFO - Start polling
2024-12-07 16:25:25,169 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 16:25:25,508 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:25:33,826 - aiogram.event - INFO - Update id=20180915 is handled. Duration 383 ms by bot id=7683347152
2024-12-07 16:25:36,610 - aiogram.event - INFO - Update id=20180916 is handled. Duration 199 ms by bot id=7683347152
2024-12-07 16:25:42,025 - aiogram.event - INFO - Update id=20180917 is handled. Duration 307 ms by bot id=7683347152
2024-12-07 16:25:45,015 - aiogram.event - INFO - Update id=20180918 is not handled. Duration 3 ms by bot id=7683347152
2024-12-07 16:25:48,270 - aiogram.event - INFO - Update id=20180919 is handled. Duration 284 ms by bot id=7683347152
2024-12-07 16:25:49,725 - aiogram.event - INFO - Update id=20180920 is handled. Duration 122 ms by bot id=7683347152
2024-12-07 16:25:52,365 - aiogram.event - INFO - Update id=20180921 is not handled. Duration 2 ms by bot id=7683347152
2024-12-07 16:25:53,434 - aiogram.event - INFO - Update id=20180922 is handled. Duration 130 ms by bot id=7683347152
2024-12-07 16:25:54,769 - aiogram.event - INFO - Update id=20180923 is handled. Duration 122 ms by bot id=7683347152
2024-12-07 16:25:59,258 - aiogram.event - INFO - Update id=20180924 is handled. Duration 134 ms by bot id=7683347152
2024-12-07 16:26:00,777 - aiogram.event - INFO - Update id=20180925 is handled. Duration 116 ms by bot id=7683347152
2024-12-07 16:26:03,072 - aiogram.event - INFO - Update id=20180926 is handled. Duration 261 ms by bot id=7683347152
2024-12-07 16:26:09,494 - aiogram.event - INFO - Update id=20180927 is handled. Duration 131 ms by bot id=7683347152
2024-12-07 16:26:11,270 - aiogram.event - INFO - Update id=20180928 is handled. Duration 119 ms by bot id=7683347152
2024-12-07 16:26:15,891 - aiogram.event - INFO - Update id=20180929 is handled. Duration 176 ms by bot id=7683347152
2024-12-07 16:26:37,220 - bot.middlewares.auth - INFO - New user registered: 1879978399
2024-12-07 16:26:37,639 - aiogram.event - INFO - Update id=20180930 is handled. Duration 420 ms by bot id=7683347152
2024-12-07 16:26:41,968 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 16:26:41,969 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 16:26:41,970 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:00:06,530 - __main__ - INFO - Loading configuration...
2024-12-07 17:00:06,531 - __main__ - INFO - Initializing bot...
2024-12-07 17:00:06,565 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:00:06,565 - __main__ - INFO - Starting bot...
2024-12-07 17:00:06,566 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:00:06,566 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:00:06,990 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:00:19,961 - aiogram.event - INFO - Update id=20180931 is handled. Duration 397 ms by bot id=7683347152
2024-12-07 17:00:30,558 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:00:30,558 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:00:30,559 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:00:30,726 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:00:57,011 - __main__ - INFO - Loading configuration...
2024-12-07 17:00:57,013 - __main__ - INFO - Initializing bot...
2024-12-07 17:00:57,032 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:00:57,032 - __main__ - INFO - Starting bot...
2024-12-07 17:00:57,032 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:00:57,032 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:00:57,368 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:01:07,535 - aiogram.event - INFO - Update id=20180932 is handled. Duration 459 ms by bot id=7683347152
2024-12-07 17:01:13,207 - aiogram.event - INFO - Update id=20180933 is handled. Duration 277 ms by bot id=7683347152
2024-12-07 17:01:17,293 - aiogram.event - INFO - Update id=20180934 is handled. Duration 255 ms by bot id=7683347152
2024-12-07 17:01:20,052 - aiogram.event - INFO - Update id=20180935 is handled. Duration 178 ms by bot id=7683347152
2024-12-07 17:01:25,218 - aiogram.event - INFO - Update id=20180936 is handled. Duration 225 ms by bot id=7683347152
2024-12-07 17:01:28,039 - aiogram.event - INFO - Update id=20180937 is handled. Duration 282 ms by bot id=7683347152
2024-12-07 17:01:30,417 - aiogram.event - INFO - Update id=20180938 is handled. Duration 202 ms by bot id=7683347152
2024-12-07 17:01:33,025 - aiogram.event - INFO - Update id=20180939 is handled. Duration 144 ms by bot id=7683347152
2024-12-07 17:01:34,620 - aiogram.event - INFO - Update id=20180940 is handled. Duration 265 ms by bot id=7683347152
2024-12-07 17:03:07,081 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: process_ozon_api_key() missing 1 required positional argument: 'marketplace_factory'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 ~~~~~~~^^
TypeError: process_ozon_api_key() missing 1 required positional argument: 'marketplace_factory'
2024-12-07 17:03:07,624 - aiogram.event - INFO - Update id=20180941 is handled. Duration 544 ms by bot id=7683347152
2024-12-07 17:03:27,631 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:03:27,632 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:03:27,633 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:05:09,776 - __main__ - INFO - Loading configuration...
2024-12-07 17:05:09,777 - __main__ - INFO - Initializing bot...
2024-12-07 17:05:09,800 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:05:09,801 - __main__ - INFO - Starting bot...
2024-12-07 17:05:09,802 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:05:09,802 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:05:10,453 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:05:18,338 - aiogram.event - INFO - Update id=20180942 is handled. Duration 362 ms by bot id=7683347152
2024-12-07 17:05:26,419 - aiogram.event - INFO - Update id=20180943 is handled. Duration 227 ms by bot id=7683347152
2024-12-07 17:05:28,844 - aiogram.event - INFO - Update id=20180944 is handled. Duration 214 ms by bot id=7683347152
2024-12-07 17:05:30,831 - aiogram.event - INFO - Update id=20180945 is handled. Duration 261 ms by bot id=7683347152
2024-12-07 17:05:34,269 - aiogram.event - INFO - Update id=20180946 is handled. Duration 144 ms by bot id=7683347152
2024-12-07 17:06:08,645 - aiogram.event - INFO - Update id=20180947 is not handled. Duration 1 ms by bot id=7683347152
2024-12-07 17:06:25,596 - aiogram.event - INFO - Update id=20180948 is handled. Duration 364 ms by bot id=7683347152
2024-12-07 17:06:27,295 - aiogram.event - INFO - Update id=20180949 is handled. Duration 134 ms by bot id=7683347152
2024-12-07 17:06:29,595 - aiogram.event - INFO - Update id=20180950 is handled. Duration 266 ms by bot id=7683347152
2024-12-07 17:06:33,052 - aiogram.event - INFO - Update id=20180951 is handled. Duration 138 ms by bot id=7683347152
2024-12-07 17:06:35,516 - aiogram.event - INFO - Update id=20180952 is handled. Duration 247 ms by bot id=7683347152
2024-12-07 17:06:37,207 - aiogram.event - INFO - Update id=20180953 is handled. Duration 299 ms by bot id=7683347152
2024-12-07 17:06:40,450 - aiogram.event - INFO - Update id=20180954 is handled. Duration 164 ms by bot id=7683347152
2024-12-07 17:06:42,537 - aiogram.event - INFO - Update id=20180955 is handled. Duration 202 ms by bot id=7683347152
2024-12-07 17:06:45,409 - aiogram.event - INFO - Update id=20180956 is handled. Duration 152 ms by bot id=7683347152
2024-12-07 17:07:04,507 - aiogram.event - INFO - Update id=20180957 is handled. Duration 363 ms by bot id=7683347152
2024-12-07 17:07:05,933 - aiogram.event - INFO - Update id=20180958 is handled. Duration 150 ms by bot id=7683347152
2024-12-07 17:07:18,331 - aiogram.event - INFO - Update id=20180959 is handled. Duration 229 ms by bot id=7683347152
2024-12-07 17:07:25,298 - aiogram.event - INFO - Update id=20180960 is handled. Duration 158 ms by bot id=7683347152
2024-12-07 17:07:26,906 - aiogram.event - INFO - Update id=20180961 is handled. Duration 129 ms by bot id=7683347152
2024-12-07 17:07:28,855 - aiogram.event - INFO - Update id=20180962 is not handled. Duration 3 ms by bot id=7683347152
2024-12-07 17:07:38,251 - aiogram.event - INFO - Update id=20180963 is not handled. Duration 3 ms by bot id=7683347152
2024-12-07 17:07:39,890 - aiogram.event - INFO - Update id=20180964 is handled. Duration 191 ms by bot id=7683347152
2024-12-07 17:07:42,601 - aiogram.event - INFO - Update id=20180965 is handled. Duration 259 ms by bot id=7683347152
2024-12-07 17:07:44,609 - aiogram.event - INFO - Update id=20180966 is handled. Duration 125 ms by bot id=7683347152
2024-12-07 17:07:46,337 - aiogram.event - INFO - Update id=20180967 is not handled. Duration 3 ms by bot id=7683347152
2024-12-07 17:07:47,977 - aiogram.event - INFO - Update id=20180968 is not handled. Duration 4 ms by bot id=7683347152
2024-12-07 17:11:50,155 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:11:50,156 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:11:50,157 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:17:24,640 - __main__ - INFO - Loading configuration...
2024-12-07 17:17:24,642 - __main__ - INFO - Initializing bot...
2024-12-07 17:17:24,662 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:17:24,662 - __main__ - INFO - Starting bot...
2024-12-07 17:17:24,662 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:17:24,662 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:17:25,466 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:17:32,778 - aiogram.event - INFO - Update id=20180969 is handled. Duration 425 ms by bot id=7683347152
2024-12-07 17:17:38,979 - aiogram.event - INFO - Update id=20180970 is handled. Duration 130 ms by bot id=7683347152
2024-12-07 17:17:42,353 - bot.middlewares.error - ERROR - Error processing event from user 743731: 'Database' object has no attribute 'get_all_users'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/admin.py", line 198, in on_admin_users
    users = await db.get_all_users()
                  ^^^^^^^^^^^^^^^^
AttributeError: 'Database' object has no attribute 'get_all_users'
2024-12-07 17:17:42,615 - aiogram.event - INFO - Update id=20180971 is handled. Duration 263 ms by bot id=7683347152
2024-12-07 17:18:02,073 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:18:02,073 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:18:02,074 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:19:02,300 - __main__ - INFO - Loading configuration...
2024-12-07 17:19:02,301 - __main__ - INFO - Initializing bot...
2024-12-07 17:19:02,319 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:19:02,319 - __main__ - INFO - Starting bot...
2024-12-07 17:19:02,319 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:19:02,319 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:19:02,653 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:19:16,489 - aiogram.event - INFO - Update id=20180972 is handled. Duration 380 ms by bot id=7683347152
2024-12-07 17:19:20,259 - aiogram.event - INFO - Update id=20180973 is handled. Duration 137 ms by bot id=7683347152
2024-12-07 17:19:21,720 - bot.middlewares.error - ERROR - Error processing event from user 743731: fromisoformat: argument must be str
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/admin.py", line 208, in on_admin_users
    text += format_user_info(user) + "\n"
            ~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/utils/messages.py", line 142, in format_user_info
    end_date = datetime.fromisoformat(end_date).strftime("%d.%m.%Y")
               ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: fromisoformat: argument must be str
2024-12-07 17:19:22,024 - aiogram.event - INFO - Update id=20180974 is handled. Duration 306 ms by bot id=7683347152
2024-12-07 17:19:58,259 - aiogram.event - INFO - Update id=20180975 is handled. Duration 453 ms by bot id=7683347152
2024-12-07 17:20:03,452 - aiogram.event - INFO - Update id=20180976 is handled. Duration 138 ms by bot id=7683347152
2024-12-07 17:20:06,865 - aiogram.event - INFO - Update id=20180977 is handled. Duration 368 ms by bot id=7683347152
2024-12-07 17:20:08,951 - aiogram.event - INFO - Update id=20180978 is handled. Duration 294 ms by bot id=7683347152
2024-12-07 17:20:14,951 - aiogram.event - INFO - Update id=20180979 is handled. Duration 268 ms by bot id=7683347152
2024-12-07 17:20:16,962 - aiogram.event - INFO - Update id=20180980 is handled. Duration 189 ms by bot id=7683347152
2024-12-07 17:20:19,866 - aiogram.event - INFO - Update id=20180981 is handled. Duration 160 ms by bot id=7683347152
2024-12-07 17:20:21,732 - aiogram.event - INFO - Update id=20180982 is handled. Duration 293 ms by bot id=7683347152
2024-12-07 17:20:24,805 - aiogram.event - INFO - Update id=20180983 is handled. Duration 134 ms by bot id=7683347152
2024-12-07 17:20:26,249 - aiogram.event - INFO - Update id=20180984 is handled. Duration 200 ms by bot id=7683347152
2024-12-07 17:20:29,558 - aiogram.event - INFO - Update id=20180985 is handled. Duration 234 ms by bot id=7683347152
2024-12-07 17:20:55,975 - aiogram.event - INFO - Update id=20180986 is handled. Duration 352 ms by bot id=7683347152
2024-12-07 17:21:01,670 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:21:01,670 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:21:01,670 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:21:13,145 - __main__ - INFO - Loading configuration...
2024-12-07 17:21:13,146 - __main__ - INFO - Initializing bot...
2024-12-07 17:21:13,163 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:21:13,163 - __main__ - INFO - Starting bot...
2024-12-07 17:21:13,163 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:21:13,163 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:21:13,493 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:21:32,620 - aiogram.event - INFO - Update id=20180987 is handled. Duration 363 ms by bot id=7683347152
2024-12-07 17:21:38,196 - aiogram.event - INFO - Update id=20180988 is handled. Duration 139 ms by bot id=7683347152
2024-12-07 17:21:40,040 - aiogram.event - INFO - Update id=20180989 is handled. Duration 503 ms by bot id=7683347152
2024-12-07 17:22:23,053 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:22:23,054 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:22:23,054 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:28:57,370 - __main__ - INFO - Loading configuration...
2024-12-07 17:28:57,371 - __main__ - INFO - Initializing bot...
2024-12-07 17:28:57,389 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:28:57,389 - __main__ - INFO - Starting bot...
2024-12-07 17:28:57,390 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:28:57,390 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:28:58,154 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:28:58,291 - bot.middlewares.auth - INFO - New user registered: 1879978399
2024-12-07 17:28:58,720 - aiogram.event - INFO - Update id=20180990 is handled. Duration 433 ms by bot id=7683347152
2024-12-07 17:29:05,691 - aiogram.event - INFO - Update id=20180991 is handled. Duration 146 ms by bot id=7683347152
2024-12-07 17:29:07,864 - aiogram.event - INFO - Update id=20180992 is handled. Duration 303 ms by bot id=7683347152
2024-12-07 17:29:09,484 - aiogram.event - INFO - Update id=20180993 is handled. Duration 253 ms by bot id=7683347152
2024-12-07 17:30:08,026 - services.marketplaces.factory - ERROR - Error creating ozon client: 
2024-12-07 17:30:08,198 - aiogram.event - INFO - Update id=20180994 is handled. Duration 617 ms by bot id=7683347152
2024-12-07 17:30:41,884 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:30:41,884 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:30:41,885 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 17:35:13,016 - __main__ - INFO - Loading configuration...
2024-12-07 17:35:13,017 - __main__ - INFO - Initializing bot...
2024-12-07 17:35:13,034 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 17:35:13,034 - __main__ - INFO - Starting bot...
2024-12-07 17:35:13,035 - aiogram.dispatcher - INFO - Start polling
2024-12-07 17:35:13,035 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 17:35:13,813 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:35:17,350 - aiogram.event - INFO - Update id=20180995 is handled. Duration 404 ms by bot id=7683347152
2024-12-07 17:35:18,645 - aiogram.event - INFO - Update id=20180996 is handled. Duration 260 ms by bot id=7683347152
2024-12-07 17:35:33,963 - services.marketplaces.base - ERROR - Connection error: 404, message='Attempt to decode JSON with unexpected mimetype: text/plain; charset=utf-8', url='https://api-seller.ozon.ru/v1/product/info/list'
2024-12-07 17:35:33,964 - services.marketplaces.factory - ERROR - Error creating ozon client: Invalid ozon API key
2024-12-07 17:35:34,137 - aiogram.event - INFO - Update id=20180997 is handled. Duration 780 ms by bot id=7683347152
2024-12-07 17:43:29,456 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 17:43:29,457 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 17:43:29,457 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:37:10,194 - __main__ - INFO - Loading configuration...
2024-12-07 21:37:10,195 - __main__ - INFO - Initializing bot...
2024-12-07 21:37:10,215 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:37:10,215 - __main__ - INFO - Starting bot...
2024-12-07 21:37:10,215 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:37:10,216 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:37:10,655 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:37:11,223 - aiogram.event - INFO - Update id=20180998 is handled. Duration 439 ms by bot id=7683347152
2024-12-07 21:37:37,742 - aiogram.event - INFO - Update id=20180999 is handled. Duration 357 ms by bot id=7683347152
2024-12-07 21:37:44,510 - aiogram.event - INFO - Update id=20181000 is handled. Duration 162 ms by bot id=7683347152
2024-12-07 21:37:46,033 - aiogram.event - INFO - Update id=20181001 is handled. Duration 308 ms by bot id=7683347152
2024-12-07 21:37:47,512 - aiogram.event - INFO - Update id=20181002 is handled. Duration 382 ms by bot id=7683347152
2024-12-07 21:37:50,088 - services.marketplaces.factory - ERROR - Error decrypting API key: 
2024-12-07 21:37:50,088 - services.marketplaces.factory - ERROR - Error creating ozon client: 
2024-12-07 21:37:50,266 - aiogram.event - INFO - Update id=20181003 is handled. Duration 367 ms by bot id=7683347152
2024-12-07 21:38:57,542 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 21:38:57,542 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:38:57,543 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:39:09,866 - __main__ - INFO - Loading configuration...
2024-12-07 21:39:09,867 - __main__ - INFO - Initializing bot...
2024-12-07 21:39:09,887 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:39:09,887 - __main__ - INFO - Starting bot...
2024-12-07 21:39:09,887 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:39:09,888 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:39:10,227 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:39:20,585 - aiogram.event - INFO - Update id=20181004 is handled. Duration 372 ms by bot id=7683347152
2024-12-07 21:39:25,330 - aiogram.event - INFO - Update id=20181005 is handled. Duration 198 ms by bot id=7683347152
2024-12-07 21:39:27,117 - aiogram.event - INFO - Update id=20181006 is handled. Duration 263 ms by bot id=7683347152
2024-12-07 21:39:28,448 - aiogram.event - INFO - Update id=20181007 is handled. Duration 248 ms by bot id=7683347152
2024-12-07 21:39:32,491 - services.marketplaces.base - ERROR - Unexpected response type: text/plain; charset=utf-8, body: 404 page not found

2024-12-07 21:39:32,491 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:39:32,633 - aiogram.event - INFO - Update id=20181008 is handled. Duration 902 ms by bot id=7683347152
2024-12-07 21:40:57,368 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 21:40:57,369 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:40:57,369 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:41:20,522 - __main__ - INFO - Loading configuration...
2024-12-07 21:41:20,523 - __main__ - INFO - Initializing bot...
2024-12-07 21:41:20,543 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:41:20,543 - __main__ - INFO - Starting bot...
2024-12-07 21:41:20,544 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:41:20,544 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:41:20,881 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:41:28,901 - aiogram.event - INFO - Update id=20181009 is handled. Duration 377 ms by bot id=7683347152
2024-12-07 21:41:33,478 - aiogram.event - INFO - Update id=20181010 is handled. Duration 163 ms by bot id=7683347152
2024-12-07 21:41:35,199 - aiogram.event - INFO - Update id=20181011 is handled. Duration 344 ms by bot id=7683347152
2024-12-07 21:41:36,462 - aiogram.event - INFO - Update id=20181012 is handled. Duration 259 ms by bot id=7683347152
2024-12-07 21:41:40,813 - services.marketplaces.base - ERROR - Unexpected response type: text/plain; charset=utf-8, body: 404 page not found

2024-12-07 21:41:40,813 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:41:41,035 - aiogram.event - INFO - Update id=20181013 is handled. Duration 692 ms by bot id=7683347152
2024-12-07 21:42:14,154 - aiogram.event - INFO - Update id=20181014 is handled. Duration 350 ms by bot id=7683347152
2024-12-07 21:42:15,660 - aiogram.event - INFO - Update id=20181015 is handled. Duration 257 ms by bot id=7683347152
2024-12-07 21:42:20,142 - services.marketplaces.factory - ERROR - Error decrypting API key: 
2024-12-07 21:42:20,142 - services.marketplaces.factory - ERROR - Error creating wildberries client: 
2024-12-07 21:42:20,273 - aiogram.event - INFO - Update id=20181016 is handled. Duration 132 ms by bot id=7683347152
2024-12-07 21:44:15,910 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 21:44:15,911 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:44:15,911 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:44:24,774 - __main__ - INFO - Loading configuration...
2024-12-07 21:44:24,775 - __main__ - INFO - Initializing bot...
2024-12-07 21:44:24,793 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:44:24,793 - __main__ - INFO - Starting bot...
2024-12-07 21:44:24,793 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:44:24,794 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:44:25,128 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:44:34,263 - aiogram.event - INFO - Update id=20181017 is handled. Duration 382 ms by bot id=7683347152
2024-12-07 21:44:38,411 - aiogram.event - INFO - Update id=20181018 is handled. Duration 141 ms by bot id=7683347152
2024-12-07 21:44:40,484 - aiogram.event - INFO - Update id=20181019 is handled. Duration 285 ms by bot id=7683347152
2024-12-07 21:44:41,693 - aiogram.event - INFO - Update id=20181020 is handled. Duration 248 ms by bot id=7683347152
2024-12-07 21:44:47,775 - services.marketplaces.base - ERROR - Unexpected response type: text/plain; charset=utf-8, body: 404 page not found

2024-12-07 21:44:47,775 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:44:47,900 - aiogram.event - INFO - Update id=20181021 is handled. Duration 944 ms by bot id=7683347152
2024-12-07 21:44:57,503 - aiogram.event - INFO - Update id=20181022 is handled. Duration 204 ms by bot id=7683347152
2024-12-07 21:44:59,179 - aiogram.event - INFO - Update id=20181023 is handled. Duration 344 ms by bot id=7683347152
2024-12-07 21:45:08,443 - services.marketplaces.base - ERROR - Unexpected response type: text/html; charset=utf-8, body: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>

2024-12-07 21:45:08,443 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:45:08,443 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: name 'logger' is not defined
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 212, in process_wb_api_key
    is_valid = await client.validate_api_key()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/services/marketplaces/wildberries.py", line 34, in validate_api_key
    await self._make_request(
    ...<3 lines>...
    )
  File "/Users/kagitin/CascadeProjects/priceguard/src/services/marketplaces/base.py", line 77, in _make_request
    raise ValueError("Invalid API key or Client ID")
ValueError: Invalid API key or Client ID

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 240, in process_wb_api_key
    logger.error(f"Error processing Wildberries API key: {str(e)}")
    ^^^^^^
NameError: name 'logger' is not defined
2024-12-07 21:45:08,894 - aiogram.event - INFO - Update id=20181024 is handled. Duration 1461 ms by bot id=7683347152
2024-12-07 21:47:33,115 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 21:47:33,115 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:47:33,116 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:49:35,861 - __main__ - INFO - Loading configuration...
2024-12-07 21:49:35,862 - __main__ - INFO - Initializing bot...
2024-12-07 21:49:35,881 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:49:35,881 - __main__ - INFO - Starting bot...
2024-12-07 21:49:35,882 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:49:35,882 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:49:36,508 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:49:46,380 - aiogram.event - INFO - Update id=20181025 is handled. Duration 375 ms by bot id=7683347152
2024-12-07 21:49:50,874 - aiogram.event - INFO - Update id=20181026 is handled. Duration 174 ms by bot id=7683347152
2024-12-07 21:49:52,510 - aiogram.event - INFO - Update id=20181027 is handled. Duration 293 ms by bot id=7683347152
2024-12-07 21:49:53,874 - aiogram.event - INFO - Update id=20181028 is handled. Duration 306 ms by bot id=7683347152
2024-12-07 21:49:59,210 - services.marketplaces.base - ERROR - Unexpected response type: application/problem+json, body: {
    "title": "path not found",
    "detail": "Please consult the https://openapi.wildberries.ru",
    "code": "9995b4770d66c-f3e1c2a5 afe5729a7d2c3880a9d26a24a4224b81",
    "requestId": "afe5729a7d2c3880a9d26a24a4224b81",
    "origin": "s2s-api-auth-dp-sandbox",
    "status": 404,
    "statusText": "Not Found",
    "timestamp": "2024-12-07T18:49:58Z"
}

2024-12-07 21:49:59,210 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:49:59,211 - bot.handlers.user - ERROR - Error processing Wildberries API key: Invalid API key or Client ID
2024-12-07 21:49:59,348 - aiogram.event - INFO - Update id=20181029 is handled. Duration 1628 ms by bot id=7683347152
2024-12-07 21:50:22,990 - aiogram.event - INFO - Update id=20181030 is handled. Duration 463 ms by bot id=7683347152
2024-12-07 21:50:24,628 - aiogram.event - INFO - Update id=20181031 is handled. Duration 361 ms by bot id=7683347152
2024-12-07 21:50:27,645 - services.marketplaces.base - ERROR - API error: No search criteria
2024-12-07 21:50:27,646 - services.marketplaces.base - ERROR - Request error: Request error: No search criteria
2024-12-07 21:50:27,646 - services.marketplaces.base - ERROR - Validation error: Request error: No search criteria
2024-12-07 21:50:27,912 - aiogram.event - INFO - Update id=20181032 is handled. Duration 1121 ms by bot id=7683347152
2024-12-07 21:53:00,620 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 21:53:00,620 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:53:00,620 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 21:53:10,842 - __main__ - INFO - Loading configuration...
2024-12-07 21:53:10,843 - __main__ - INFO - Initializing bot...
2024-12-07 21:53:10,863 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 21:53:10,863 - __main__ - INFO - Starting bot...
2024-12-07 21:53:10,863 - aiogram.dispatcher - INFO - Start polling
2024-12-07 21:53:10,863 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 21:53:11,329 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 21:53:20,277 - aiogram.event - INFO - Update id=20181033 is handled. Duration 372 ms by bot id=7683347152
2024-12-07 21:53:24,578 - aiogram.event - INFO - Update id=20181034 is handled. Duration 272 ms by bot id=7683347152
2024-12-07 21:53:25,934 - aiogram.event - INFO - Update id=20181035 is handled. Duration 211 ms by bot id=7683347152
2024-12-07 21:53:27,520 - aiogram.event - INFO - Update id=20181036 is handled. Duration 244 ms by bot id=7683347152
2024-12-07 21:53:30,910 - services.marketplaces.base - ERROR - Unexpected response type: text/plain; charset=utf-8, body: 404 page not found

2024-12-07 21:53:30,910 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:53:31,122 - aiogram.event - INFO - Update id=20181037 is handled. Duration 687 ms by bot id=7683347152
2024-12-07 21:53:38,050 - aiogram.event - INFO - Update id=20181038 is handled. Duration 174 ms by bot id=7683347152
2024-12-07 21:53:39,622 - aiogram.event - INFO - Update id=20181039 is handled. Duration 280 ms by bot id=7683347152
2024-12-07 21:53:44,360 - services.marketplaces.base - ERROR - Unexpected response type: application/problem+json, body: {
    "title": "path not found",
    "detail": "Please consult the https://openapi.wildberries.ru",
    "code": "9995b4770d66c-f3e1c2a5 100383f3cea0510517f9c548ba59a5a0",
    "requestId": "100383f3cea0510517f9c548ba59a5a0",
    "origin": "s2s-api-auth-dp-sandbox",
    "status": 404,
    "statusText": "Not Found",
    "timestamp": "2024-12-07T18:53:43Z"
}

2024-12-07 21:53:44,360 - services.marketplaces.base - ERROR - Validation error: Invalid API key or Client ID
2024-12-07 21:53:44,361 - bot.handlers.user - ERROR - Error processing Wildberries API key: Invalid API key or Client ID
2024-12-07 21:53:44,497 - aiogram.event - INFO - Update id=20181040 is handled. Duration 1263 ms by bot id=7683347152
2024-12-07 22:03:03,042 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:03:03,045 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:03:03,046 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:03:14,202 - __main__ - INFO - Loading configuration...
2024-12-07 22:03:14,203 - __main__ - INFO - Initializing bot...
2024-12-07 22:03:14,224 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:03:14,224 - __main__ - INFO - Starting bot...
2024-12-07 22:03:14,225 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:03:14,225 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:03:14,665 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:03:26,302 - aiogram.event - INFO - Update id=20181041 is handled. Duration 406 ms by bot id=7683347152
2024-12-07 22:03:30,791 - aiogram.event - INFO - Update id=20181042 is handled. Duration 142 ms by bot id=7683347152
2024-12-07 22:03:32,231 - aiogram.event - INFO - Update id=20181043 is handled. Duration 225 ms by bot id=7683347152
2024-12-07 22:03:33,570 - aiogram.event - INFO - Update id=20181044 is handled. Duration 258 ms by bot id=7683347152
2024-12-07 22:03:39,071 - services.marketplaces.base - ERROR - Validation error: Invalid API endpoint or Client ID
2024-12-07 22:03:39,224 - aiogram.event - INFO - Update id=20181045 is handled. Duration 1057 ms by bot id=7683347152
2024-12-07 22:07:13,190 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:07:13,191 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:07:13,192 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:07:23,760 - __main__ - INFO - Loading configuration...
2024-12-07 22:07:23,761 - __main__ - INFO - Initializing bot...
2024-12-07 22:07:23,782 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:07:23,782 - __main__ - INFO - Starting bot...
2024-12-07 22:07:23,782 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:07:23,783 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:07:24,590 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:07:35,811 - aiogram.event - INFO - Update id=20181046 is handled. Duration 434 ms by bot id=7683347152
2024-12-07 22:07:41,572 - aiogram.event - INFO - Update id=20181047 is handled. Duration 137 ms by bot id=7683347152
2024-12-07 22:07:43,065 - aiogram.event - INFO - Update id=20181048 is handled. Duration 313 ms by bot id=7683347152
2024-12-07 22:07:44,368 - aiogram.event - INFO - Update id=20181049 is handled. Duration 267 ms by bot id=7683347152
2024-12-07 22:07:48,040 - aiogram.event - INFO - Update id=20181050 is handled. Duration 1060 ms by bot id=7683347152
2024-12-07 22:07:59,542 - aiogram.event - INFO - Update id=20181051 is handled. Duration 149 ms by bot id=7683347152
2024-12-07 22:08:03,311 - aiogram.event - INFO - Update id=20181052 is handled. Duration 286 ms by bot id=7683347152
2024-12-07 22:14:13,082 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:14:13,083 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:14:13,084 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:17:49,497 - __main__ - INFO - Loading configuration...
2024-12-07 22:17:49,498 - __main__ - INFO - Initializing bot...
2024-12-07 22:17:49,518 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:17:49,518 - __main__ - INFO - Starting bot...
2024-12-07 22:17:49,519 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:17:49,519 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:17:50,243 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:18:04,282 - aiogram.event - INFO - Update id=20181053 is handled. Duration 465 ms by bot id=7683347152
2024-12-07 22:18:07,757 - aiogram.event - INFO - Update id=20181054 is handled. Duration 133 ms by bot id=7683347152
2024-12-07 22:18:09,410 - aiogram.event - INFO - Update id=20181055 is handled. Duration 269 ms by bot id=7683347152
2024-12-07 22:18:10,567 - aiogram.event - INFO - Update id=20181056 is handled. Duration 258 ms by bot id=7683347152
2024-12-07 22:18:14,930 - aiogram.event - INFO - Update id=20181057 is handled. Duration 1282 ms by bot id=7683347152
2024-12-07 22:18:35,575 - aiogram.event - INFO - Update id=20181058 is handled. Duration 399 ms by bot id=7683347152
2024-12-07 22:18:40,294 - aiogram.event - INFO - Update id=20181059 is handled. Duration 126 ms by bot id=7683347152
2024-12-07 22:18:42,609 - aiogram.event - INFO - Update id=20181060 is handled. Duration 316 ms by bot id=7683347152
2024-12-07 22:18:57,181 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:18:57,182 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:18:57,182 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:30:39,132 - __main__ - INFO - Loading configuration...
2024-12-07 22:30:39,133 - __main__ - INFO - Initializing bot...
2024-12-07 22:30:39,150 - __main__ - ERROR - Error in main function: name 'register_all_handlers' is not defined
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 65, in main
    register_all_handlers(dp, config, dp["db"])
    ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'register_all_handlers' is not defined
2024-12-07 22:31:45,630 - __main__ - INFO - Loading configuration...
2024-12-07 22:31:45,630 - __main__ - INFO - Initializing bot...
2024-12-07 22:31:45,649 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:31:45,649 - __main__ - INFO - Starting bot...
2024-12-07 22:31:45,650 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:31:45,650 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:31:46,571 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:31:58,012 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: format_subscription_status() missing 2 required positional arguments: 'end_date' and 'check_interval'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 418, in show_subscription
    status_text = await format_subscription_status(user_data)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TypeError: format_subscription_status() missing 2 required positional arguments: 'end_date' and 'check_interval'
2024-12-07 22:31:58,485 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-07 22:31:58,485 - aiogram.event - INFO - Update id=20181061 is handled. Duration 478 ms by bot id=7683347152
2024-12-07 22:32:11,479 - aiogram.event - INFO - Update id=20181062 is handled. Duration 263 ms by bot id=7683347152
2024-12-07 22:32:13,236 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: format_subscription_status() missing 2 required positional arguments: 'end_date' and 'check_interval'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 418, in show_subscription
    status_text = await format_subscription_status(user_data)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
TypeError: format_subscription_status() missing 2 required positional arguments: 'end_date' and 'check_interval'
2024-12-07 22:32:13,395 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-07 22:32:13,395 - aiogram.event - INFO - Update id=20181063 is handled. Duration 163 ms by bot id=7683347152
2024-12-07 22:33:00,406 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:33:00,407 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:33:00,408 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:33:27,339 - __main__ - INFO - Loading configuration...
2024-12-07 22:33:27,340 - __main__ - INFO - Initializing bot...
2024-12-07 22:33:27,360 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:33:27,360 - __main__ - INFO - Starting bot...
2024-12-07 22:33:27,360 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:33:27,361 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:33:27,690 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:33:38,632 - aiogram.event - INFO - Update id=20181064 is handled. Duration 515 ms by bot id=7683347152
2024-12-07 22:33:40,038 - aiogram.event - INFO - Update id=20181065 is handled. Duration 222 ms by bot id=7683347152
2024-12-07 22:33:43,272 - aiogram.event - INFO - Update id=20181066 is handled. Duration 156 ms by bot id=7683347152
2024-12-07 22:34:06,702 - aiogram.event - INFO - Update id=20181067 is handled. Duration 342 ms by bot id=7683347152
2024-12-07 22:34:22,776 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:34:22,777 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:34:22,777 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:36:15,760 - __main__ - INFO - Loading configuration...
2024-12-07 22:36:15,761 - __main__ - INFO - Initializing bot...
2024-12-07 22:36:15,778 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:36:15,778 - __main__ - INFO - Starting bot...
2024-12-07 22:36:15,778 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:36:15,778 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:36:16,576 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:36:21,830 - aiogram.event - INFO - Update id=20181068 is handled. Duration 591 ms by bot id=7683347152
2024-12-07 22:36:24,221 - aiogram.event - INFO - Update id=20181069 is handled. Duration 251 ms by bot id=7683347152
2024-12-07 22:36:25,784 - aiogram.event - INFO - Update id=20181070 is handled. Duration 380 ms by bot id=7683347152
2024-12-07 22:36:27,335 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: 'Config' object has no attribute 'payment_provider_token'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/payment.py", line 62, in process_plan_selection
    provider_token=settings.payment_provider_token,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'payment_provider_token'
2024-12-07 22:36:27,498 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-07 22:36:27,498 - aiogram.event - INFO - Update id=20181071 is handled. Duration 166 ms by bot id=7683347152
2024-12-07 22:37:19,306 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:37:19,306 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:37:19,307 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:38:10,884 - __main__ - INFO - Loading configuration...
2024-12-07 22:38:10,884 - __main__ - INFO - Initializing bot...
2024-12-07 22:38:10,904 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:38:10,904 - __main__ - INFO - Starting bot...
2024-12-07 22:38:10,904 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:38:10,904 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:38:11,233 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:38:20,500 - aiogram.event - INFO - Update id=20181072 is handled. Duration 509 ms by bot id=7683347152
2024-12-07 22:38:22,888 - aiogram.event - INFO - Update id=20181073 is handled. Duration 233 ms by bot id=7683347152
2024-12-07 22:38:24,840 - aiogram.event - INFO - Update id=20181074 is handled. Duration 339 ms by bot id=7683347152
2024-12-07 22:38:26,703 - aiogram.event - INFO - Update id=20181075 is handled. Duration 278 ms by bot id=7683347152
2024-12-07 22:39:48,311 - aiogram.event - INFO - Update id=20181076 is handled. Duration 372 ms by bot id=7683347152
2024-12-07 22:39:58,432 - aiogram.event - INFO - Update id=20181077 is handled. Duration 136 ms by bot id=7683347152
2024-12-07 22:40:08,072 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:40:08,073 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:40:08,073 - aiogram.dispatcher - INFO - Polling stopped
2024-12-07 22:42:18,931 - __main__ - INFO - Loading configuration...
2024-12-07 22:42:18,932 - __main__ - INFO - Initializing bot...
2024-12-07 22:42:18,950 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-07 22:42:18,951 - __main__ - INFO - Starting bot...
2024-12-07 22:42:18,951 - aiogram.dispatcher - INFO - Start polling
2024-12-07 22:42:18,952 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-07 22:42:19,733 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:42:34,107 - aiogram.event - INFO - Update id=20181078 is handled. Duration 544 ms by bot id=7683347152
2024-12-07 22:42:36,194 - aiogram.event - INFO - Update id=20181079 is handled. Duration 282 ms by bot id=7683347152
2024-12-07 22:42:37,717 - aiogram.event - INFO - Update id=20181080 is handled. Duration 407 ms by bot id=7683347152
2024-12-07 22:42:38,972 - aiogram.event - INFO - Update id=20181081 is handled. Duration 433 ms by bot id=7683347152
2024-12-07 22:42:57,928 - aiogram.event - INFO - Update id=20181082 is handled. Duration 341 ms by bot id=7683347152
2024-12-07 22:43:00,102 - aiogram.event - INFO - Update id=20181083 is handled. Duration 160 ms by bot id=7683347152
2024-12-07 22:43:24,105 - aiogram.event - INFO - Update id=20181084 is handled. Duration 607 ms by bot id=7683347152
2024-12-07 22:46:19,840 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-07 22:46:19,840 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-07 22:46:19,841 - aiogram.dispatcher - INFO - Polling stopped
2024-12-08 09:30:57,130 - __main__ - INFO - Loading configuration...
2024-12-08 09:30:57,131 - __main__ - INFO - Initializing bot...
2024-12-08 09:30:57,152 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-08 09:30:57,152 - __main__ - INFO - Starting bot...
2024-12-08 09:30:57,153 - aiogram.dispatcher - INFO - Start polling
2024-12-08 09:30:57,153 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-08 09:30:57,769 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:31:03,399 - aiogram.event - INFO - Update id=20181085 is handled. Duration 391 ms by bot id=7683347152
2024-12-08 09:31:10,632 - aiogram.event - INFO - Update id=20181086 is handled. Duration 352 ms by bot id=7683347152
2024-12-08 09:31:50,266 - aiogram.event - INFO - Update id=20181087 is handled. Duration 480 ms by bot id=7683347152
2024-12-08 09:32:47,227 - aiogram.event - INFO - Update id=20181088 is handled. Duration 397 ms by bot id=7683347152
2024-12-08 09:32:59,728 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: format_subscription_status() got an unexpected keyword argument 'status'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 127, in cmd_status
    format_subscription_status(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        status=user_data["subscription_status"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        end_date=user_data["subscription_end_date"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        check_interval=user_data["check_interval"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
TypeError: format_subscription_status() got an unexpected keyword argument 'status'
2024-12-08 09:32:59,880 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-08 09:32:59,881 - aiogram.event - INFO - Update id=20181089 is handled. Duration 154 ms by bot id=7683347152
2024-12-08 09:33:13,999 - aiogram.event - INFO - Update id=20181090 is handled. Duration 245 ms by bot id=7683347152
2024-12-08 09:33:19,453 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-08 09:33:19,453 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:33:19,454 - aiogram.dispatcher - INFO - Polling stopped
2024-12-08 09:38:35,619 - __main__ - INFO - Loading configuration...
2024-12-08 09:38:35,620 - __main__ - INFO - Initializing bot...
2024-12-08 09:38:35,634 - __main__ - ERROR - Error in main function: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN: 'Markdown'>)` argument instead.
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/main.py", line 48, in main
    bot = Bot(token=config.telegram.token, parse_mode=ParseMode.MARKDOWN)
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/client/bot.py", line 310, in __init__
    raise TypeError(
    ...<3 lines>...
    )
TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN: 'Markdown'>)` argument instead.
2024-12-08 09:39:20,575 - __main__ - INFO - Loading configuration...
2024-12-08 09:39:20,575 - __main__ - INFO - Initializing bot...
2024-12-08 09:39:20,594 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-08 09:39:20,594 - __main__ - INFO - Starting bot...
2024-12-08 09:39:20,594 - aiogram.dispatcher - INFO - Start polling
2024-12-08 09:39:20,595 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-08 09:39:21,024 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:39:21,158 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: name 'InlineKeyboardBuilder' is not defined
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 439, in cmd_menu
    reply_markup=get_main_menu_keyboard()
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/keyboards/user.py", line 113, in get_main_menu_keyboard
    builder = InlineKeyboardBuilder()
              ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'InlineKeyboardBuilder' is not defined. Did you mean: 'InlineKeyboardButton'?
2024-12-08 09:39:21,610 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-08 09:39:21,610 - aiogram.event - INFO - Update id=20181091 is handled. Duration 454 ms by bot id=7683347152
2024-12-08 09:40:11,303 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-08 09:40:11,304 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:40:11,304 - aiogram.dispatcher - INFO - Polling stopped
2024-12-08 09:46:58,838 - __main__ - INFO - Loading configuration...
2024-12-08 09:46:58,839 - __main__ - INFO - Initializing bot...
2024-12-08 09:46:59,476 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-08 09:46:59,477 - __main__ - INFO - Starting bot...
2024-12-08 09:46:59,477 - aiogram.dispatcher - INFO - Start polling
2024-12-08 09:46:59,477 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-08 09:46:59,590 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:47:09,784 - aiogram.event - INFO - Update id=20181092 is handled. Duration 356 ms by bot id=7683347152
2024-12-08 09:47:15,821 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: name 'InlineKeyboardBuilder' is not defined
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 453, in cmd_menu
    reply_markup=get_main_menu_keyboard()
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/keyboards/user.py", line 113, in get_main_menu_keyboard
    builder = InlineKeyboardBuilder()
              ^^^^^^^^^^^^^^^^^^^^^
NameError: name 'InlineKeyboardBuilder' is not defined. Did you mean: 'InlineKeyboardButton'?
2024-12-08 09:47:15,995 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-08 09:47:15,995 - aiogram.event - INFO - Update id=20181093 is handled. Duration 176 ms by bot id=7683347152
2024-12-08 09:47:45,492 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-08 09:47:45,493 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:47:45,493 - aiogram.dispatcher - INFO - Polling stopped
2024-12-08 09:55:03,095 - __main__ - INFO - Loading configuration...
2024-12-08 09:55:03,096 - __main__ - INFO - Initializing bot...
2024-12-08 09:55:03,845 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-08 09:55:03,846 - __main__ - INFO - Starting bot...
2024-12-08 09:55:03,846 - aiogram.dispatcher - INFO - Start polling
2024-12-08 09:55:03,846 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-08 09:55:03,957 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 09:55:19,516 - aiogram.event - INFO - Update id=20181094 is handled. Duration 359 ms by bot id=7683347152
2024-12-08 09:55:26,474 - aiogram.event - INFO - Update id=20181095 is handled. Duration 130 ms by bot id=7683347152
2024-12-08 09:55:51,329 - aiogram.event - INFO - Update id=20181096 is handled. Duration 428 ms by bot id=7683347152
2024-12-08 09:55:55,694 - aiogram.event - INFO - Update id=20181097 is handled. Duration 267 ms by bot id=7683347152
2024-12-08 09:55:57,835 - aiogram.event - INFO - Update id=20181098 is handled. Duration 146 ms by bot id=7683347152
2024-12-08 09:56:22,654 - aiogram.event - INFO - Update id=20181099 is handled. Duration 357 ms by bot id=7683347152
2024-12-08 09:56:24,834 - aiogram.event - INFO - Update id=20181100 is handled. Duration 331 ms by bot id=7683347152
2024-12-08 09:56:30,124 - aiogram.event - INFO - Update id=20181101 is handled. Duration 208 ms by bot id=7683347152
2024-12-08 09:56:31,522 - aiogram.event - INFO - Update id=20181102 is handled. Duration 174 ms by bot id=7683347152
2024-12-08 09:56:33,441 - aiogram.event - INFO - Update id=20181103 is handled. Duration 250 ms by bot id=7683347152
2024-12-08 09:56:45,755 - aiogram.event - INFO - Update id=20181104 is handled. Duration 173 ms by bot id=7683347152
2024-12-08 09:56:48,664 - aiogram.event - INFO - Update id=20181105 is handled. Duration 214 ms by bot id=7683347152
2024-12-08 09:56:50,037 - aiogram.event - INFO - Update id=20181106 is handled. Duration 255 ms by bot id=7683347152
2024-12-08 09:56:55,632 - aiogram.event - INFO - Update id=20181107 is handled. Duration 163 ms by bot id=7683347152
2024-12-08 09:56:57,031 - aiogram.event - INFO - Update id=20181108 is handled. Duration 188 ms by bot id=7683347152
2024-12-08 09:56:58,651 - aiogram.event - INFO - Update id=20181109 is handled. Duration 252 ms by bot id=7683347152
2024-12-08 09:58:04,908 - aiogram.event - INFO - Update id=20181110 is handled. Duration 482 ms by bot id=7683347152
2024-12-08 09:58:17,931 - aiogram.event - INFO - Update id=20181111 is handled. Duration 127 ms by bot id=7683347152
2024-12-08 09:58:25,522 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: format_subscription_status() got an unexpected keyword argument 'status'
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 141, in cmd_status
    format_subscription_status(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        status=user_data["subscription_status"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        end_date=user_data["subscription_end_date"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        check_interval=user_data["check_interval"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
TypeError: format_subscription_status() got an unexpected keyword argument 'status'
2024-12-08 09:58:25,649 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-08 09:58:25,649 - aiogram.event - INFO - Update id=20181112 is handled. Duration 129 ms by bot id=7683347152
2024-12-08 09:58:33,429 - aiogram.event - INFO - Update id=20181113 is handled. Duration 123 ms by bot id=7683347152
2024-12-08 10:00:06,787 - aiogram.dispatcher - WARNING - Received SIGINT signal
2024-12-08 10:00:06,787 - aiogram.dispatcher - INFO - Polling stopped for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 10:00:06,788 - aiogram.dispatcher - INFO - Polling stopped
2024-12-08 10:00:32,115 - __main__ - INFO - Loading configuration...
2024-12-08 10:00:32,116 - __main__ - INFO - Initializing bot...
2024-12-08 10:00:32,863 - services.monitoring.monitor - INFO - Started promotion monitoring task
2024-12-08 10:00:32,863 - __main__ - INFO - Starting bot...
2024-12-08 10:00:32,864 - aiogram.dispatcher - INFO - Start polling
2024-12-08 10:00:32,864 - services.monitoring.monitor - ERROR - Error in monitoring loop: 'Database' object has no attribute 'get_active_subscriptions'
2024-12-08 10:00:32,975 - aiogram.dispatcher - INFO - Run polling for bot @priceguarddev_bot id=7683347152 - 'priceguarddev'
2024-12-08 10:00:34,952 - aiogram.event - INFO - Update id=20181114 is handled. Duration 370 ms by bot id=7683347152
2024-12-08 10:00:40,403 - bot.middlewares.error - ERROR - Error processing event from user 1879978399: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=<coroutine object format_...n_status at 0x10d874c20>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
Traceback (most recent call last):
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/middlewares/error.py", line 21, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/Users/kagitin/CascadeProjects/priceguard/src/bot/handlers/user.py", line 140, in cmd_status
    await message.answer(
          ~~~~~~~~~~~~~~^
        format_subscription_status(user_data),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        reply_markup=get_subscription_keyboard()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/aiogram/types/message.py", line 2091, in answer
    return SendMessage(
           ~~~~~~~~~~~^
        chat_id=self.chat.id,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<15 lines>...
        **kwargs,
        ^^^^^^^^^
    ).as_(self._bot)
    ^
  File "/Users/kagitin/CascadeProjects/priceguard/venv/lib/python3.13/site-packages/pydantic/main.py", line 212, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=<coroutine object format_...n_status at 0x10d874c20>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-12-08 10:00:40,536 - bot.middlewares.error - ERROR - Failed to notify admin about error: 'config'
2024-12-08 10:00:40,537 - aiogram.event - INFO - Update id=20181115 is handled. Duration 137 ms by bot id=7683347152
2024-12-08 10:00:51,667 - aiogram.event - INFO - Update id=20181116 is handled. Duration 128 ms by bot id=7683347152
2024-12-08 10:00:53,497 - aiogram.event - INFO - Update id=20181117 is handled. Duration 480 ms by bot id=7683347152
2024-12-08 10:00:54,676 - aiogram.event - INFO - Update id=20181118 is handled. Duration 245 ms by bot id=7683347152
2024-12-08 10:00:58,712 - aiogram.event - INFO - Update id=20181119 is handled. Duration 211 ms by bot id=7683347152
2024-12-08 10:01:01,133 - aiogram.event - INFO - Update id=20181120 is handled. Duration 134 ms by bot id=7683347152
2024-12-08 10:01:03,207 - aiogram.event - INFO - Update id=20181121 is handled. Duration 128 ms by bot id=7683347152
2024-12-08 10:01:04,953 - aiogram.event - INFO - Update id=20181122 is handled. Duration 497 ms by bot id=7683347152
2024-12-08 10:01:06,333 - aiogram.event - INFO - Update id=20181123 is handled. Duration 254 ms by bot id=7683347152
2024-12-08 10:01:08,162 - aiogram.event - INFO - Update id=20181124 is handled. Duration 138 ms by bot id=7683347152
2024-12-08 10:01:09,791 - aiogram.event - INFO - Update id=20181125 is handled. Duration 210 ms by bot id=7683347152
2024-12-08 10:01:11,471 - aiogram.event - INFO - Update id=20181126 is handled. Duration 374 ms by bot id=7683347152
