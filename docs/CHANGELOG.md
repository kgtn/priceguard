# Changelog

## [Unreleased]

### Changed
- Унифицировано форматирование уведомлений для Ozon и Wildberries
- Улучшено отображение акций Ozon Hot Sale с учетом названий и периодов проведения акций
- Обновлен стиль уведомлений с использованием древовидной структуры

## [1.2.0] - 2024-12-17

### Added
- Отображение информации о текущих акциях в меню "Акции"
- Проверка доступности бота для пользователя перед мониторингом акций
- Автоматическое прекращение проверок для пользователей, заблокировавших бота
- Реализована система очередей для API запросов (QueueManager)
- Добавлен RateLimiter для контроля частоты запросов к API
- Реализован сервис уведомлений с форматированием Markdown
- Добавлена поддержка эмодзи в уведомлениях
- Улучшена обработка ошибок при отправке уведомлений
- Интеграция с API Wildberries для получения количества товаров в акциях
- Форматирование дат в уведомлениях об акциях

### Changed
- Улучшена обработка ошибок при проверке акций
- Оптимизирована работа с кэшем акций
- Улучшено форматирование уведомлений об акциях
- Улучшен формат уведомлений о промо-акциях
- Оптимизирована работа с API маркетплейсов через систему очередей
- Улучшена структура уведомлений для Ozon и Wildberries
- Изменен механизм мониторинга акций для работы с очередями
- Обновлен интерфейс NotificationService

### Fixed
- Исправлена ошибка повторного нажатия кнопки "Акции"
- Исправлено отображение сообщения при отсутствии API ключей
- Исправлена проблема с перегрузкой API при множественных запросах
- Улучшена обработка ошибок при работе с API
- Исправлена проблема с форматированием уведомлений

## [1.1.0] - 2024-12-14

### Added
- Добавлен механизм graceful shutdown для корректной остановки бота
- Реализована обработка сигналов SIGINT и SIGTERM
- Добавлена функция очистки ресурсов при остановке бота
- Улучшено логирование процесса остановки
- Добавлено логирование проверки ключей Ozon
- Настроена система пробного периода (триал)
- Добавлены уведомления при окончании подписки
- Реализована автоматическая деактивация аккаунта при окончании подписки
- Добавлена рассылка сообщений из меню администратора

### Changed
- Оптимизирована структура документации
- Обновлён README.md с улучшенной структурой и навигацией
- Улучшена организация технической документации
- Улучшен интерфейс списка пользователей в панели администратора
- Оптимизирована логика продления подписки (суммирование сроков действия)
- Изменен дефолтный интервал проверки акций на 4 часа (14400 сек)
- Улучшена проверка товаров Ozon: поэтапный запрос hotsales и информации о товарах
- Упрощена логика проверки товаров в автоакциях (подсчет количества акций)
- Оптимизирована работа с API ключами (объединение операций обновления)

### Fixed
- Исправлена утечка ресурсов при остановке бота
- Улучшена обработка исключений в основном цикле бота
- Исправлена ошибка при регистрации новых пользователей
- Улучшена проверка прав администратора (через middleware)
- Исправлены ошибки в системе подписок
- Улучшены информационные сообщения для пользователей

### Security
- Удалены временные файлы и артефакты сборки из Git
- Улучшена обработка конфиденциальных данных (.env файл)

## [1.0.0] - 2024-12-07

### Added
- Интеграция с Telegram Payments
- Мониторинг акций на Ozon и Wildberries
- Система подписок (месячная, квартальная, годовая)
- Уведомления об изменениях в акциях
- Безопасное хранение API ключей
- Базовая документация

### Changed
- Переход с YooKassa на Telegram Payments
- Улучшена структура проекта
- Оптимизирована работа с API маркетплейсов

### Fixed
- Обработка ошибок API маркетплейсов
- Валидация платежей
- Форматирование уведомлений

## [0.1.0] - 2024-12-01

### Added
- Базовый функционал бота
- Интеграция с YooKassa
- Простой мониторинг акций
